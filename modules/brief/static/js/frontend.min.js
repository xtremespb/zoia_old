"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(_){var a="zoiaFormBuilder",i={load:{url:"#",method:"POST"},save:{url:"#",method:"POST"},captcha:"/api/captcha",items:[],edit:!1,validation:!0,html:{helpText:'<div class="uk-text-meta">{text}</div>',text:'<div class="uk-margin-bottom"><label class="uk-form-label" for="{prefix}_{name}">{label}:{bullet}</label><br><div class="uk-form-controls"><input class="uk-input {prefix}-form-field{css}" id="{prefix}_{name}" type="{type}" placeholder=""{autofocus}><div id="{prefix}_{name}_error_text" class="{prefix}-error-text" style="display:none"><span class="uk-label-danger"></span></div>{helpText}</div></div>',select:'<div class="uk-margin-bottom"><label class="uk-form-label" for="{prefix}_{name}">{label}:{bullet}</label><br><select{multiple} class="uk-select {prefix}-form-field{css}" id="{prefix}_{name}"{autofocus}>{values}</select><div id="{prefix}_{name}_error_text" class="{prefix}-error-text" style="display:none"><span class="uk-label-danger"></span></div>{helpText}</div>',passwordConfirm:'<div class="uk-margin"><label class="uk-form-label" for="{prefix}_{name}">{label}:{bullet}</label><div class="uk-flex"><div class="{prefix}-field-wrap"><input class="uk-input {prefix}-form-field" id="{prefix}_{name}" type="password" placeholder=""{autofocus}></div><div><input class="uk-input {prefix}-form-field" id="{prefix}_{name}Confirm" type="password" placeholder=""></div></div><div id="{prefix}_{name}_error_text" class="{prefix}-error-text" style="display:none"><span class="uk-label-danger"></span></div>{helpText}</div>',captcha:'<div class="uk-margin"><label class="uk-form-label" for="{prefix}_{name}">{label}:{bullet}</label><div class="uk-grid uk-grid-small"><div><input class="uk-input {prefix}-form-field {prefix}-captcha-field{css}" type="text" placeholder="" id="{prefix}_{name}"{autofocus}></div><div><div class="uk-form-controls"><img class="{prefix}-captcha-img"></div></div></div><div id="{prefix}_{name}_error_text" class="{prefix}-error-text" style="display:none"><span class="uk-label-danger"></span></div>{helpText}',buttonsWrap:'<div class="{css}">{buttons}{html}</div>',button:'<button class="uk-button {prefix}-form-button{css}" id="{prefix}_{name}" type="{type}">{label}</button>',launcher:'<div class="uk-margin"><label class="uk-form-label" for="{prefix}_{name}_btn">{label}:{bullet}</label><div class="uk-flex"><div id="{prefix}_{name}_val" class="{prefix}-{name}-selector" data="{data}">{value}</div><div><button class="uk-button uk-button-default" id="{prefix}_{name}_btn" type="button">{labelBtn}</button></div></div>{helpText}{html}</div>',textarea:'<div class="uk-margin-bottom"><label class="uk-form-label" for="{prefix}_{name}">{label}:{bullet}</label><br><div class="uk-form-controls"><textarea class="uk-textarea {prefix}-form-field{css}" id="{prefix}_{name}"{autofocus}></textarea><div id="{prefix}_{name}_error_text" class="{prefix}-error-text" style="display:none"><span class="uk-label-danger"></span></div>{helpText}</div></div>',checkboxlistItem:'<li><label><input class="uk-checkbox {prefix}-{name}-cbx" type="checkbox" data="{title}">&nbsp;&nbsp;{title}</label></li>',checkboxlist:'<div class="uk-margin-bottom"><label class="uk-form-label" for="{prefix}_{name}">{label}:{bullet}</label><div class="uk-panel uk-panel-scrollable{css}" id="{prefix}_{name}_wrap"><ul class="uk-list">{items}</ul></div>{helpText}</div>',valueslistItem:'<div class="uk-flex uk-margin-top {prefix}-{name}-item"><div class="uk-margin-right"><input placeholder="{langParameter}" type="text" class="uk-input formBuilder-valueslist-par" value="{key}"></div><div class="uk-margin-right"><input placeholder="{langValue}" type="text" class="uk-input formBuilder-valueslist-val" value="{value}"></div><div style="padding-top:3px"><button class="uk-icon-button uk-button-danger formBuilder-valueslist-btnDel" uk-icon="icon:minus"></button></div></div>',valueslistItemFixed:'<div class="uk-flex uk-margin-top {prefix}-{name}-item"><div class="uk-margin-right">{key}</div><div class="uk-margin-right"><input placeholder="{langValue}" type="text" class="uk-input formBuilder-valueslist-val" value="{value}"></div></div>',valueslist:'<div class="uk-flex uk-flex-column"><div class="uk-margin-bottom"><label class="uk-form-label">{label}:{bullet}</label></div><div><button type="button" class="uk-icon-button uk-button-primary formBuilder-valueslist-btnAdd" id="{prefix}_{name}_btnAdd" uk-icon="icon:plus" data-prefix="{prefix}" data-name="{name}"></button></div><div id="{prefix}_{name}_wrap" class="uk-margin-bottom {prefix}-formBuilder-valueslist-wrap">{items}</div></div>',bullet:'&nbsp;<span style="color:red;font-size:120%">&#8226;</span>'},template:{fields:"{fields}",buttons:"{buttons}"},lang:{mandatoryMissing:"Should not be empty",tooShort:"Too short",tooLong:"Too long",invalidFormat:"Doesn't match required format",passwordsNotMatch:"Passwords do not match",parameter:"Parameter",value:"Value"},events:{onInit:function(){},onSaveSubmit:function(){},onSaveValidate:function(){},onSaveSuccess:function(){},onSaveError:function(){},onLoadStart:function(){},onLoadSuccess:function(){},onLoadError:function(){}},formDangerClass:"uk-form-danger"},s=function(e,t){this.element=e,this.settings=_.extend({},i,t),this._defaults=i,this._name=a,this._prefix=this.element.id,this._formTypes=["text","email","password","tags","select","passwordConfirm","captcha","launcher","textarea","checkboxlist","valueslist","valueslistfixed","valueslisteditable"],this._saving=!1,this.init()};_.extend(s.prototype,{init:function(){var e="",t="";for(var a in this.settings.items){var i=this.settings.items[a],s="";switch((i.validation&&!this.settings.edit&&i.validation.mandatoryCreate||i.validation&&this.settings.edit&&i.validation.mandatoryEdit)&&(s=this.settings.html.bullet),i.type){case"text":case"email":case"password":case"tags":e+=this._template(this.settings.html.text,{prefix:this._prefix,name:a,label:i.label,bullet:s,css:i.css?" "+i.css:"",autofocus:i.autofocus?"autofocus":"",helpText:i.helpText?this._template(this.settings.html.helpText,{text:i.helpText,prefix:this._prefix}):"",type:i.type});break;case"launcher":e+=this._template(this.settings.html.launcher,{prefix:this._prefix,name:a,label:i.label,bullet:s,labelBtn:i.labelBtn,data:i.data,value:i.value,css:i.css?" "+i.css:"",helpText:i.helpText?this._template(this.settings.html.helpText,{text:i.helpText,prefix:this._prefix}):"",html:i.html?" "+i.html:""});break;case"valueslist":var l="";for(var r in i.values)l+=this._template(this.settings.html.valueslistItem,{prefix:this._prefix,name:a,key:i.values[r].p,value:i.values[r].v,langParameter:this.settings.lang.parameter,langValue:this.settings.lang.value});e+=this._template(this.settings.html.valueslist,{prefix:this._prefix,name:a,label:i.label,bullet:s,items:l});break;case"valueslisteditable":var n="";for(var o in i.values)n+=this._template(i.values[o].t?this.settings.html.valueslistItemEditablePostfix:this.settings.html.valueslistItemEditable,{prefix:this._prefix,name:a,key:i.values[o].p,value:i.values[o].v,postfix:i.values[o].t,langParameter:this.settings.lang.parameter,langValue:this.settings.lang.value});e+=this._template(this.settings.html.valueslistEditable,{prefix:this._prefix,name:a,label:i.label,bullet:s,items:n,helpText:i.helpText?this._template(this.settings.html.helpText,{text:i.helpText,prefix:this._prefix}):"",buttons:i.buttons||""});break;case"valueslistfixed":var u="";for(var p in i.values)u+=this._template(this.settings.html.valueslistItemFixed,{prefix:this._prefix,name:a,key:i.values[p].p,value:i.values[p].t,data:i.values[p].v,langParameter:this.settings.lang.parameter,langValue:this.settings.lang.value});e+=this._template(this.settings.html.valueslistFixed,{prefix:this._prefix,name:a,label:i.label,bullet:s,items:u});break;case"select":var f="";for(var d in i.values)f+='<option value="'+d+'">'+i.values[d]+"</option>";e+=this._template(this.settings.html.select,{prefix:this._prefix,name:a,label:i.label,bullet:s,css:i.css?" "+i.css:"",multiple:i.multiple?" multiple":"",autofocus:i.autofocus?"autofocus":"",helpText:i.helpText?this._template(this.settings.html.helpText,{text:i.helpText,prefix:this._prefix}):"",type:i.type,values:f});break;case"checkboxlist":var c="";for(var h in i.values)c+=this._template(this.settings.html.checkboxlistItem,{prefix:this._prefix,name:a,title:i.values[h]});e+=this._template(this.settings.html.checkboxlist,{prefix:this._prefix,name:a,label:i.label,bullet:s,css:i.css?" "+i.css:"",multiple:i.multiple?" multiple":"",helpText:i.helpText?this._template(this.settings.html.helpText,{text:i.helpText,prefix:this._prefix}):"",items:c});break;case"passwordConfirm":e+=this._template(this.settings.html.passwordConfirm,{prefix:this._prefix,name:a,label:i.label,bullet:s,css:i.css?" "+i.css:"",autofocus:i.autofocus?"autofocus":"",helpText:i.helpText?this._template(this.settings.html.helpText,{text:i.helpText,prefix:this._prefix}):"",type:"password"});break;case"captcha":e+=this._template(this.settings.html.captcha,{prefix:this._prefix,name:a,css:i.css?" "+i.css:"",label:i.label,bullet:s,helpText:i.helpText?this._template(this.settings.html.helpText,{text:i.helpText,prefix:this._prefix}):"",autofocus:i.autofocus?"autofocus":""});break;case"textarea":e+=this._template(this.settings.html.textarea,{prefix:this._prefix,name:a,label:i.label,bullet:s,rows:i.rows?i.rows:"2",css:i.css?" "+i.css:"",autofocus:i.autofocus?"autofocus":"",helpText:i.helpText?this._template(this.settings.html.helpText,{text:i.helpText,prefix:this._prefix}):""});break;case"buttons":for(var m="",v=0;v<i.buttons.length;v++){var x=i.buttons[v];m+=this._template(this.settings.html.button,{css:x.css?" "+x.css:"",prefix:this._prefix,name:x.name||"button"+v,type:x.type||"button",label:x.label||""})+"&nbsp;"}t+=this._template(this.settings.html.buttonsWrap,{prefix:this._prefix,css:i.css?" "+i.css:"",buttons:m,html:i.html?" "+i.html:""})}}_(this.element).html(this._template(this.settings.template.fields,{fields:e})+this._template(this.settings.template.buttons,{buttons:t})),_(".formBuilder-valueslist-btnAdd").unbind(),_(".formBuilder-valueslist-btnAdd").click(function(e){g._valueslistAddFunc(_(this).attr("data-prefix"),_(this).attr("data-name"),"","")}),_(".formBuilder-valueslist-btnDel").unbind(),_(".formBuilder-valueslist-btnDel").click(function(e){_(this).parent().parent().remove()}),_(".formBuilder-valueslistfixed-btnAdd").unbind(),_(".formBuilder-valueslistfixed-btnAdd").click(function(e){g._valueslistfixedAddFunc(_(this).attr("data-prefix"),_(this).attr("data-name"),"","")}),_(".formBuilder-valueslistfixed-btnDel").unbind(),_(".formBuilder-valueslistfixed-btnDel").click(function(e){_(this).parent().parent().remove()}),_(".formBuilder-valueslisteditable-btnAdd").unbind(),_(".formBuilder-valueslisteditable-btnAdd").click(function(e){g._valueslistAddFunc(_(this).attr("data-prefix"),_(this).attr("data-name"),"","")}),_(".formBuilder-valueslisteditable-btnDel").unbind(),_(".formBuilder-valueslisteditable-btnDel").click(function(e){_(this).parent().parent().remove()}),this.settings.events.onInit&&this.settings.events.onInit();var g=this;for(var b in _(this.element).submit(function(e){e.preventDefault(),g._submit()}),this._captchaInit(),this.settings.items){this.settings.items[b].autofocus&&_("#"+this._prefix+"_"+b).focus()}},_valueslistAddFunc:function(e,t,a,i,s){var l=this._template(this.settings.html.valueslistItem,{prefix:e,name:t,key:a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),value:i,langParameter:this.settings.lang.parameter,langValue:this.settings.lang.value});_("#"+e+"_"+t+"_wrap").append(l),s||_("."+e+"-"+t+"-item").last().find("div>input:first").focus(),_(".formBuilder-valueslist-btnDel").unbind(),_(".formBuilder-valueslist-btnDel").click(function(e){e.stopPropagation(),_(this).parent().parent().remove()})},_valueslisteditableAddFunc:function(e,t,a,i,s,l,r){if(l="undefined"===l?null:l,a){a=String(a);var n=this._template(l?this.settings.html.valueslistItemEditablePostfix:this.settings.html.valueslistItemEditable,{prefix:e,name:t,key:a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),value:i,data:s,postfix:l,langParameter:this.settings.lang.parameter,langValue:this.settings.lang.value});_("#"+e+"_"+t+"_wrap").append(n),r||_("."+e+"-"+t+"-item").last().find("div>input:first").focus(),_(".formBuilder-valueslisteditable-btnDel").unbind(),_(".formBuilder-valueslisteditable-btnDel").click(function(e){e.stopPropagation(),_(this).parent().parent().remove()})}},_valueslistfixedAddFunc:function(e,t,a,i,s){var l=this._template(this.settings.html.valueslistfixedItem,{prefix:e,name:t,key:a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),value:i,langParameter:this.settings.lang.parameter,langValue:this.settings.lang.value});_("#"+e+"_"+t+"_wrap").append(l),s||_("."+e+"-"+t+"-item").last().find("div>input:first").focus(),_(".formBuilder-valueslistfixed-btnDel").unbind(),_(".formBuilder-valueslistfixed-btnDel").click(function(e){e.stopPropagation(),_(this).parent().parent().remove()})},setValidation:function(e){this.validation=e},setEditMode:function(e){this.settings.edit=e},clearErrors:function(){_("."+this._prefix+"-form-field").removeClass(this.settings.formDangerClass),_("."+this._prefix+"-error-text").hide()},resetForm:function(){this.clearErrors();for(var e in _("."+this._prefix+"-form-field").not(".zoiaFormBuilder-no-reset").val(""),_("select."+this._prefix+"-form-field").prop("selectedIndex",0),_(".formBuilder-valueslist-val").val(""),_("."+this._prefix+"-formBuilder-valueslist-wrap").html(""),this.settings.items){var t=this.settings.items[e];t.default&&_("#"+this._prefix+"_"+e).val(t.default),"launcher"===t.type&&(_("#"+this._prefix+"_"+e+"_val").html(t.value),_("#"+this._prefix+"_"+e+"_val").attr("data",t.data)),"checkboxlist"===t.type&&_("."+this._prefix+"-"+e+"-cbx").prop("checked",!1)}},serialize:function(){var s=this,l={};for(var r in this.settings.items){var n=this.settings.items[r];-1!==this._formTypes.indexOf(n.type)&&function(){switch(n.type){case"launcher":l[r]={type:n.type,value:_("#"+s._prefix+"_"+r+"_val").html(),id:_("#"+s._prefix+"_"+r+"_val").attr("data")};break;case"checkboxlist":var e=_("."+s._prefix+"-"+r+"-cbx:checked").map(function(){return _(this).attr("data")}).get();l[r]={type:n.type,value:e.join(",")};break;case"valueslist":var t=[];_("."+s._prefix+"-"+r+"-item").each(function(){t.push({p:String(_(this).find("*>.formBuilder-valueslist-par").val()),v:String(_(this).find("*>.formBuilder-valueslist-val").val())})}),l[r]={type:n.type,value:t};break;case"valueslisteditable":var a=[];_("."+s._prefix+"-"+r+"-item").each(function(){a.push({p:String(_(this).find("*>.formBuilder-valueslist-par").html()),v:String(_(this).find("*>.formBuilder-valueslist-val").val()),d:String(_(this).find("*>.formBuilder-valueslist-val").attr("data")),t:String(_(this).find("*>.formBuilder-valueslist-val").attr("data-postfix"))})}),l[r]={type:n.type,value:a};break;case"valueslistfixed":var i=[];_("."+s._prefix+"-"+r+"-item").each(function(){i.push({p:String(_(this).find("*>.formBuilder-valueslist-val").attr("data")),v:String(_(this).find("*>.formBuilder-valueslist-val").val())})}),l[r]={type:n.type,value:i};break;default:l[r]={type:n.type,value:_("#"+s._prefix+"_"+r).val()}}}()}return l},deserialize:function(e){if(e&&"object"===(void 0===e?"undefined":_typeof(e)))for(var t in this.settings.items)switch(e[t]||(e[t]={id:"",value:""}),e[t].type){case"launcher":_("#"+this._prefix+"_"+t+"_val").html(e[t].value),_("#"+this._prefix+"_"+t+"_val").attr("data",e[t].id);break;case"checkboxlist":var a=e[t].value.split(",");for(var i in a)_('.editForm-groups-cbx[data="'+a[i]+'"]').prop("checked",!0);break;case"valueslist":var s=[];for(var l in e[t].value)s.push(e[t].value[l].p),s.push(e[t].value[l].v);for(_("#"+this._prefix+"_"+t+"_wrap").html("");0<s.length;){var r=s.shift(),n=s.shift();this._valueslistAddFunc(this._prefix,t,r,n,!0)}break;case"valueslisteditable":var o=[];for(var u in e[t].value)o.push(e[t].value[u].p),o.push(e[t].value[u].v),o.push(e[t].value[u].d),o.push(e[t].value[u].t);for(_("#"+this._prefix+"_"+t+"_wrap").html("");0<o.length;){var p=o.shift(),f=o.shift(),d=o.shift(),c=o.shift();this._valueslisteditableAddFunc(this._prefix,t,p,f,d,c,!0)}break;case"valueslistfixed":for(var h in _("."+this._prefix+"-"+t+"-item-val").val(""),e[t].value)_("."+this._prefix+"-"+t+'-item-val[data="'+e[t].value[h].p+'"]').val(e[t].value[h].v);break;default:_("#"+this._prefix+"_"+t).val(e[t].value||"")}},deserializePart:function(e,t){if(t&&"object"===(void 0===t?"undefined":_typeof(t)))switch(t||(t={id:"",value:""}),t.type){case"launcher":_("#"+this._prefix+"_"+e+"_val").html(t.value),_("#"+this._prefix+"_"+e+"_val").attr("data",t.id);break;case"checkboxlist":var a=t.value.split(",");for(var i in a)_('.editForm-groups-cbx[data="'+a[i]+'"]').prop("checked",!0);break;case"valueslist":var s=[];for(var l in t.value)s.push(t.value[l].p),s.push(t.value[l].v);for(_("#"+this._prefix+"_"+e+"_wrap").html("");0<s.length;){var r=s.shift(),n=s.shift();this._valueslistAddFunc(this._prefix,e,r,n,!0)}break;case"valueslisteditable":var o=[];for(var u in t.value)o.push(t.value[u].p),o.push(t.value[u].v),o.push(t.value[u].d),o.push(t.value[u].t);for(_("#"+this._prefix+"_"+e+"_wrap").html("");0<o.length;){var p=o.shift(),f=o.shift(),d=o.shift(),c=o.shift();this._valueslisteditableAddFunc(this._prefix,e,p,f,d,c,!0)}break;case"valueslistfixed":for(var h in _("."+this._prefix+"-"+e+"-item-val").val(""),t.value)_("."+this._prefix+"-"+e+'-item-val[data="'+t.value[h].p+'"]').val(t.value[h].v);break;default:_("#"+this._prefix+"_"+e).val(t.value||"")}},loadJSON:function(e){var f=this,d=this;jQuery.each(e,function(e,t){if(_("#"+d._prefix+"_"+e).val(t),d.settings.items[e]&&"checkboxlist"===d.settings.items[e].type&&t){var a=t.split(",");for(var i in a)_('.editForm-groups-cbx[data="'+a[i]+'"]').prop("checked",!0)}if(d.settings.items[e]&&"valueslist"===d.settings.items[e].type&&t){var s=[];for(var l in t)s.push(l),s.push(t[l]);for(var r in _("#"+d._prefix+"_"+e+"_wrap").html(""),t)d._valueslistAddFunc(d._prefix,e,s.shift(),s.shift())}if(d.settings.items[e]&&"valueslisteditable"===d.settings.items[e].type&&t){var n=[];for(var o in t)n.push(o),n.push(t[o]);for(var u in _("#"+d._prefix+"_"+e+"_wrap").html(""),t)d._valueslisteditableAddFunc(d._prefix,e,n.shift(),n.shift(),n.shift(),n.shift())}if(d.settings.items[e]&&"valueslistfixed"===d.settings.items[e].type&&t)for(var p in _("."+f._prefix+"-"+e+"-item-val").val(""),t)_("."+f._prefix+"-"+e+'-item-val[data="'+t[p].p+'"]').val(t[p].v)})},loadData:function(e){var f=this;this.settings.events.onLoadStart&&this.settings.events.onLoadStart(),this.resetForm();var d=this;_.ajax({type:this.settings.load.method,url:this.settings.load.url,data:e,cache:!1}).done(function(e){e&&1===e.status?(jQuery.each(e.item,function(e,t){if(_("#"+d._prefix+"_"+e).val(t),d.settings.items[e]&&"checkboxlist"===d.settings.items[e].type&&t){var a=t.split(",");for(var i in a)_('.editForm-groups-cbx[data="'+a[i]+'"]').prop("checked",!0)}if(d.settings.items[e]&&"valueslist"===d.settings.items[e].type&&t){var s=[];for(var l in t)s.push(l),s.push(t[l]);for(var r in _("#"+d._prefix+"_"+e+"_wrap").html(""),t)d._valueslistAddFunc(d._prefix,e,s.shift(),s.shift())}if(d.settings.items[e]&&"valueslisteditable"===d.settings.items[e].type&&t){var n=[];for(var o in t)n.push(o),n.push(t[o]);for(var u in _("#"+d._prefix+"_"+e+"_wrap").html(""),t)d._valueslisteditableAddFunc(d._prefix,e,n.shift(),n.shift(),n.shift())}if(d.settings.items[e]&&"valueslistfixed"===d.settings.items[e].type&&t)for(var p in _("."+f._prefix+"-"+e+"-item-val").val(""),t)_("."+f._prefix+"-"+e+'-item-val[data="'+t[p].p+'"]').val(t[p].v)}),d.settings.events.onLoadSuccess&&d.settings.events.onLoadSuccess(e)):d.settings.events.onLoadError&&d.settings.events.onLoadError(e)}).fail(function(e,t){d.settings.events.onLoadError&&d.settings.events.onLoadError(e,t)})},captchaRefresh:function(){_("."+this._prefix+"-captcha-img").show(),_("."+this._prefix+"-captcha-img").attr("src",this.settings.captcha+"?"+(new Date).getTime()),_("."+this._prefix+"-captcha-field").val("")},_captchaInit:function(){this.captchaRefresh();var e=this;_("img."+this._prefix+"-captcha-img").click(function(){e.captchaRefresh()})},_template:function(e,t){for(var a in t)e=e.replace(new RegExp("{"+a+"}","g"),t[a]);return e},validate:function(t){var a=this,e={},i={};for(var s in this.settings.items){var l=this.settings.items[s];if(-1!==this._formTypes.indexOf(l.type))if("launcher"!==l.type){if("valueslist"===l.type)if("continue"===function(){if(t&&t[s])return i[s]=t[s].value,"continue";var e=[];return _("."+a._prefix+"-"+s+"-item").each(function(){e.push({p:String(_(this).find("*>.formBuilder-valueslist-par").val()),v:String(_(this).find("*>.formBuilder-valueslist-val").val())})}),i[s]=e,"continue"}())continue;if("valueslisteditable"===l.type)if("continue"===function(){if(t&&t[s])return i[s]=t[s].value,"continue";var e=[];return _("."+a._prefix+"-"+s+"-item").each(function(){e.push({p:String(_(this).find("*>.formBuilder-valueslist-par").val()),v:String(_(this).find("*>.formBuilder-valueslist-val").val())})}),i[s]=e,"continue"}())continue;if("valueslistfixed"===l.type)if("continue"===function(){if(t&&t[s])return i[s]=t[s].value,"continue";var e=[];return _("."+a._prefix+"-"+s+"-item").each(function(){e.push({p:String(_(this).find("*>.formBuilder-valueslist-val").attr("data")),v:String(_(this).find("*>.formBuilder-valueslist-val").val())})}),i[s]=e,"continue"}())continue;if("checkboxlist"!==l.type){var r=t?t[s]?t[s].value:void 0:_("#"+this._prefix+"_"+s).val();if(l.validation){if(!l.validation.mandatoryEdit&&!r&&this.settings.edit||!l.validation.mandatoryCreate&&!r&&!this.settings.edit)continue;if(l.validation.mandatoryCreate&&!r&&!this.settings.edit){e[s]=this.settings.lang.mandatoryMissing;continue}if(l.validation.mandatoryEdit&&!r&&this.settings.edit){e[s]=this.settings.lang.mandatoryMissing;continue}if(l.validation.process&&"function"==typeof l.validation.process&&(r=l.validation.process(r)),"passwordConfirm"===l.type)if(_("#"+this._prefix+"_"+s+"Confirm").val()!==r){e[s]=this.settings.lang.passwordsNotMatch;continue}if(l.validation.length){if(l.validation.length.min&&r.length<l.validation.length.min){e[s]=this.settings.lang.tooShort;continue}if(l.validation.length.max&&r.length>l.validation.length.max){e[s]=this.settings.lang.tooLong;continue}}if(l.validation.regexp&&!r.match(l.validation.regexp)){e[s]=this.settings.lang.invalidFormat;continue}i[s]=r}}else{var n=_("."+this._prefix+"-"+s+"-cbx:checked").map(function(){return _(this).attr("data")}).get();i[s]=t?t[s]?t[s].value:void 0:n.join(",")}}else i[s]=t?t[s]?t[s].id:void 0:_("#"+this._prefix+"_"+s+"_val").attr("data")}return{data:i,errors:e}},errors:function(e){if(0<Object.keys(e).length){var t=!1;for(var a in e)_("#"+this._prefix+"_"+a).addClass(this.settings.formDangerClass),_("#"+this._prefix+"_"+a+"_error_text > span").html(e[a]),_("#"+this._prefix+"_"+a+"_error_text").show(),t||(_("#"+this._prefix+"_"+a).focus(),t=!0),"passwordConfirm"===this.settings.items[a].type&&_("#"+this._prefix+"_"+a+"Confirm").addClass(this.settings.formDangerClass);return!0}return!1},_submit:function(){if(!this._saving){this.settings.events.onSaveSubmit&&this.settings.events.onSaveSubmit(),this.clearErrors();var i=this,e={},t={};if(this.settings.validation){var a=this.validate();if(e=a.data||{},t=a.errors||{},this.errors(t))return;if(this.settings.events.onSaveValidate&&"__stop"===(e=this.settings.events.onSaveValidate(e,t)||e))return}else if(this.settings.events.onSaveValidate&&"__stop"===(e=this.settings.events.onSaveValidate(e)))return;i._saving=!0,_.ajax({type:this.settings.save.method,url:this.settings.save.url,data:e,cache:!1}).done(function(e){if(i._saving=!1,e&&1===e.status)i.settings.events.onSaveSuccess&&i.settings.events.onSaveSuccess(e);else{if(e.fields)for(var t in e.fields){var a=!1;_("#"+i._prefix+"_"+e.fields[t]).addClass(i.settings.formDangerClass),a||(_("#"+i._prefix+"_"+e.fields[t]).focus(),a=!0)}i.captchaRefresh(),i.settings.events.onSaveError&&i.settings.events.onSaveError(e)}}).fail(function(e,t){i._saving=!1,i.captchaRefresh(),i.settings.events.onSaveError&&i.settings.events.onSaveError(e,t)})}}}),_.fn[a]=function(e){var t=void 0;return this.each(function(){(t=_.data(this,"plugin_"+a))||(t=new s(this,e),_.data(this,"plugin_"+a,t))}),t}}(jQuery,window,document),function(){var e=void 0;$(document).ready(function(){e=$("#zp_locale").attr("data"),$.getScript("/api/lang/brief/"+e+".js").done(function(){$("#zoiaBrief").zoiaFormBuilder({save:{url:"/api/brief/post",method:"POST"},formDangerClass:"za-form-danger",template:{fields:"{fields}",buttons:"{buttons}"},html:{helpText:'<div class="za-text-meta">{text}</div>',text:'<div class="za-margin"><label class="za-form-label" for="{prefix}_{name}">{label}:</label><div class="za-form-controls"><input class="za-input {prefix}-form-field{css}" id="{prefix}_{name}" type="{type}" placeholder=""{autofocus}><div id="{prefix}_{name}_error_text" class="{prefix}-error-text" style="display:none"><span class="za-label-danger"></span></div>{helpText}</div></div>',select:'<div class="za-margin"><label class="za-form-label" for="{prefix}_{name}">{label}:</label><div class="za-form-controls"><select class="za-select {prefix}-form-field{css}" id="{prefix}_{name}"{autofocus}>{values}</select></div></div><div id="{prefix}_{name}_error_text" class="{prefix}-error-text" style="display:none"><span class="za-label-danger"></span></div>{helpText}</div>',passwordConfirm:'<div class="za-margin"><label class="za-form-label" for="{prefix}_{name}">{label}:</label><div class="za-flex"><div class="{prefix}-field-wrap"><input class="za-input {prefix}-form-field" id="{prefix}_{name}" type="password" placeholder=""{autofocus}></div><div><input class="za-input {prefix}-form-field" id="{prefix}_{name}Confirm" type="password" placeholder=""></div></div><div id="{prefix}_{name}_error_text" class="{prefix}-error-text" style="display:none"><span class="za-label-danger"></span></div>{helpText}</div>',captcha:'<div class="za-margin"><label class="za-form-label" for="{prefix}_{name}">{label}:</label><div class="za-form-controls"><input class="za-input {prefix}-form-field{css} {prefix}-captcha-field{css}" id="{prefix}_{name}" type="{type}" placeholder=""{autofocus}>&nbsp;<img class="{prefix}-captcha-img"><div id="{prefix}_{name}_error_text" class="{prefix}-error-text" style="display:none"><span class="za-label-danger"></span></div>{helpText}</div></div>',buttonsWrap:'<div class="{css}">{buttons}{html}</div>',button:'<button class="za-button {prefix}-form-button{css}" id="{prefix}_{name}" type="{type}">{label}</button>',launcher:'<div class="za-margin"><label class="za-form-label" for="{prefix}_{name}_btn">{label}:</label><div class="za-flex"><div id="{prefix}_{name}_val" class="{prefix}-{name}-selector" data="{data}">{value}</div><div><button class="za-button za-button-default" id="{prefix}_{name}_btn" type="button">{labelBtn}</button></div></div>{helpText}</div>',textarea:'<div class="za-margin"><label class="za-form-label" for="{prefix}_{name}">{label}:</label><div class="za-form-controls"><textarea rows="{rows}" class="za-textarea {prefix}-form-field{css}" id="{prefix}_{name}"{autofocus}></textarea><div id="{prefix}_{name}_error_text" class="{prefix}-error-text" style="display:none"><span class="za-label-danger"></span></div>{helpText}</div></div>'},lang:{mandatoryMissing:lang["Should not be empty"],tooShort:lang["Too short"],tooLong:lang["Too long"],invalidFormat:lang["Doesn't match required format"],passwordsNotMatch:lang["Passwords do not match"]},events:{onInit:function(){},onSaveSubmit:function(){},onSaveValidate:function(){$("#zoiaBriefSpinner").show()},onSaveSuccess:function(){$("#zoiaBriefSpinner").hide(),$("#zoiaBriefSuccess").show(),$("#zoiaBrief").hide()},onSaveError:function(e){$("#zoiaBriefSpinner").hide(),e&&-3!==parseInt(e.status,10)?($("#zoiaBriefError>p").html(lang["Error while loading data from server."]).parent().show(),$("#zoiaBriefError")[0].scrollIntoView(!0)):$("#zoiaBrief_captcha").focus()}},items:{title:{type:"text",label:lang["Company title"],css:"za-form-width-large",autofocus:!0,helpText:lang["Your company or project title"],validation:{mandatoryCreate:!0,length:{min:3,max:64},process:function(e){return e.trim()}}},contact:{type:"textarea",rows:5,label:lang["Contact person, contact information"],css:"za-form-width-large",autofocus:!1,helpText:lang["A person to contact, phone etc."],validation:{mandatoryCreate:!0,length:{min:3,max:256},process:function(e){return e.trim()}}},email:{type:"text",label:lang["E-mail"],css:"za-form-width-large",autofocus:!1,helpText:lang["Your valid e-mail address"],validation:{mandatoryCreate:!0,length:{min:3,max:64},regexp:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,process:function(e){return e.trim()}}},products:{type:"textarea",rows:5,label:lang["Products or services you provide"],css:"za-form-width-large",autofocus:!1,helpText:lang["A brief information about your services or products"],validation:{mandatoryCreate:!0,length:{min:3,max:256},process:function(e){return e.trim()}}},identity:{type:"select",label:lang["Does your company have a logo or corporate identity?"],css:"za-form-width-small",autofocus:!1,values:{1:lang.Yes,0:lang.No},value:0,validation:{mandatoryCreate:!1,regexp:/^(0|1)$/,process:function(e){return e}}},slogan:{type:"text",label:lang.Slogan,css:"za-form-width-large",autofocus:!1,helpText:lang["Your slogan or corporate motto"],validation:{mandatoryCreate:!1,length:{min:3,max:256},process:function(e){return e.trim()}}},website:{type:"select",label:lang["Does your company have a website?"],css:"za-form-width-small",autofocus:!1,values:{1:lang.Yes,0:lang.No},value:0,validation:{mandatoryCreate:!1,regexp:/^(0|1)$/,process:function(e){return e}}},message:{type:"textarea",rows:5,label:lang["General message for your customers"],css:"za-form-width-large",autofocus:!1,helpText:lang["Which message is necessary to bring to the consciousness of the visitors?"],validation:{mandatoryCreate:!1,length:{min:3,max:256},process:function(e){return e.trim()}}},purpose:{type:"textarea",rows:5,label:lang["Purpose(s) of the website"],css:"za-form-width-large",autofocus:!1,helpText:lang["Which tasks should your website solve?"],validation:{mandatoryCreate:!1,length:{min:3,max:256},process:function(e){return e.trim()}}},colors:{type:"textarea",label:lang.Colors,css:"za-form-width-large",autofocus:!1,helpText:lang["Which colors you wish to use and why?"],validation:{mandatoryCreate:!1,length:{min:3,max:256},process:function(e){return e.trim()}}},competitors:{type:"textarea",rows:5,label:lang.Competitors,css:"za-form-width-large",autofocus:!1,helpText:lang["2-3 websites of your competitors"],validation:{mandatoryCreate:!1,length:{min:3,max:256},process:function(e){return e.trim()}}},examples:{type:"textarea",rows:7,label:lang["Website examples"],css:"za-form-width-large",autofocus:!1,helpText:lang["Which sites you like might be used as examples?"],validation:{mandatoryCreate:!1,length:{min:3,max:256},process:function(e){return e.trim()}}},nexamples:{type:"textarea",rows:7,label:lang["Negative website examples"],css:"za-form-width-large",autofocus:!1,helpText:lang["Which sites might NOT be used as examples?"],validation:{mandatoryCreate:!1,length:{min:3,max:256},process:function(e){return e.trim()}}},hosting:{type:"select",label:lang["Did you find a hoster?"],css:"za-form-width-small",autofocus:!1,values:{1:lang.Yes,0:lang.No},value:0,validation:{mandatoryCreate:!1,regexp:/^(0|1)$/,process:function(e){return e}}},domains:{type:"textarea",label:lang["Domain name(s)"],css:"za-form-width-large",autofocus:!1,helpText:lang["Domain name(s) you wish to use"],validation:{mandatoryCreate:!1,length:{min:3,max:256},process:function(e){return e.trim()}}},type:{type:"select",label:lang["Type of your new website"],css:"za-form-width-medium",autofocus:!1,values:{0:lang.types[0],1:lang.types[1],2:lang.types[2],3:lang.types[3],4:lang.types[4],5:lang.types[5],6:lang.types[6]},validation:{mandatoryCreate:!1,regexp:/^(0|1|2|3|4|5|6)$/,process:function(e){return e}}},navigation:{type:"textarea",rows:7,label:lang.Navigation,css:"za-form-width-large",autofocus:!1,helpText:lang["Planned website navigation areas"],validation:{mandatoryCreate:!1,length:{min:3,max:256},process:function(e){return e.trim()}}},content:{type:"select",label:lang["Website content ready"],css:"za-form-width-small",autofocus:!1,values:{1:lang.Yes,0:lang.No},value:0,validation:{mandatoryCreate:!1,regexp:/^(0|1)$/,process:function(e){return e}}},pcontent:{type:"select",label:lang["Primary content placement"],css:"za-form-width-small",autofocus:!1,values:{1:lang.Yes,0:lang.No},value:0,validation:{mandatoryCreate:!1,regexp:/^(0|1)$/,process:function(e){return e}}},support:{type:"select",label:lang["Production stage support"],css:"za-form-width-small",autofocus:!1,values:{1:lang.Yes,0:lang.No},value:0,validation:{mandatoryCreate:!1,regexp:/^(0|1)$/,process:function(e){return e}}},pages:{type:"text",label:lang["Pages count (approx.)"],css:"za-form-width-medium",autofocus:!1,helpText:lang["How many pages will be publishes (approx.)"],validation:{mandatoryCreate:!0,length:{min:1,max:32},process:function(e){return e.trim()}}},budget:{type:"text",label:lang["Planned budget (approx.)"],css:"za-form-width-medium",autofocus:!1,helpText:lang["Your planned budget for your website"],validation:{mandatoryCreate:!0,length:{min:1,max:32},process:function(e){return e.trim()}}},captcha:{type:"captcha",label:lang.Code,helpText:lang["Code you see on the picture"],validation:{mandatoryCreate:!0,length:{min:4,max:4},regexp:/^[0-9]+$/,process:function(e){return e.trim()}}},buttons:{type:"buttons",css:"za-margin-top",buttons:[{name:"btnSave",label:'<div za-spinner class="za-margin-right" id="zoiaBriefSpinner" style="display:none"></div>'+lang.Send,css:"za-button-primary",type:"submit"}]}}})})})}();