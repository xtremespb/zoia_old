"use strict";!function(){var r=void 0,e=function(){$(".rf-captcha-img").show(),$(".rf-captcha-img").attr("src","/api/captcha?"+(new Date).getTime()),$("#rf_captcha").val("")},i=function(){$(".zoia-rfield").removeClass("za-form-danger"),$(".zoia-review-error").hide();var a=$("#rf_name").val().trim(),e=$("#rf_text").val().trim(),i=$("#rf_captcha").val().trim();return!a||!a.match(/^[^<>'\"/;`%]*$/)||60<a.length?($(".zoia-review-error-text").html(lang["Name is missing or contains invalid characters"]),$("#rf_name").addClass("za-form-danger").focus(),$(".zoia-review-error").show()):!e||2048<e.length?($(".zoia-review-error-text").html(lang["Text is missing or is too long"]),$("#rf_text").addClass("za-form-danger").focus(),$(".zoia-review-error").show()):i&&i.match(/^[0-9]{4}$/)?($("#zoiaReviewDialogSpinner").show(),$("#zoiaReviewDialogWrap").hide(),void $.ajax({type:"POST",url:"/api/reviews/add",cache:!1,data:{name:a,text:e,captcha:i}}).done(function(a){$("#zoiaReviewDialogSpinner").hide(),$("#zoiaReviewDialogWrap").show(),1===a.status?(r.hide(),$("#zoia_review_add").hide(),$zUI.modal.alert(lang["Your review has been accepted for moderation."],{labels:{ok:lang.OK}})):(a.field?$("#rf_"+a.field).focus().addClass("za-form-danger"):$("#rf_name").focus(),$zUI.notification(a.error||lang["Error while loading data"],{status:"danger",timeout:1500}))}).fail(function(){$("#zoiaReviewDialogSpinner").hide(),$("#zoiaReviewDialogWrap").show(),$("#rf_name").focus(),$zUI.notification(lang["Error while loading data"],{status:"danger",timeout:1500})},200)):($(".zoia-review-error-text").html(lang["Invalid captcha"]),$("#rf_captcha").addClass("za-form-danger").focus(),$(".zoia-review-error").show())};$(document).ready(function(){var a=$("#zp_locale").attr("data");$.getScript("/api/lang/reviews/"+a+".js").done(function(){r=$zUI.modal("#zoiaReviewDialog",{bgClose:!1,escClose:!1}),$("#zoia_review_add").click(function(){$(".zoia-review-error").hide(),$(".zoia-rfield").val("").removeClass("za-form-danger"),r.show().then(function(){$("#rf_name").focus()})}),$("#zoia_review_form").submit(function(a){a.preventDefault(),i()}),$("#zoia_btn_review_save").click(i),e(),$(".rf-captcha-img").click(function(){e()})})})}();